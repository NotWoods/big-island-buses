{"version":3,"file":"service-worker.js","sources":["src/service-worker.ts"],"sourcesContent":["const CACHE = 'network-or-cache';\r\n\r\nexport declare var self: ServiceWorkerGlobalScope;\r\n\r\nself.addEventListener('install', evt => {\r\n    evt.waitUntil(precache());\r\n});\r\n\r\nself.addEventListener('fetch', evt => {\r\n    evt.respondWith(\r\n        fromNetwork(evt.request, 400).catch(() => fromCache(evt.request)),\r\n    );\r\n});\r\n\r\nfunction precache() {\r\n    return caches\r\n        .open(CACHE)\r\n        .then(cache =>\r\n            cache.addAll([\r\n                './',\r\n                'index.html',\r\n                'style.css',\r\n                'main.js',\r\n                'google_transit.zip',\r\n                'assets/logo.svg',\r\n                'assets/lines.svg',\r\n                'roboto/Roboto-Regular.ttf',\r\n                'roboto/Roboto-Medium.ttf',\r\n            ]),\r\n        );\r\n}\r\n\r\nfunction fromNetwork(request: RequestInfo, timeout: number) {\r\n    return new Promise<Response>((resolve, reject) => {\r\n        const timeoutId = setTimeout(reject, timeout);\r\n        fetch(request).then(response => {\r\n            clearTimeout(timeoutId);\r\n            resolve(response);\r\n        }, reject);\r\n    });\r\n}\r\n\r\nfunction fromCache(request: RequestInfo) {\r\n    return caches\r\n        .open(CACHE)\r\n        .then(cache => cache.match(request))\r\n        .then(matching => {\r\n            if (matching) {\r\n                return matching;\r\n            } else {\r\n                throw new Error('no-match');\r\n            }\r\n        });\r\n}\r\n"],"names":[],"mappings":"AAAA,MAAM,KAAK,GAAG,kBAAkB,CAAC;AAIjC,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,GAAG;IAChC,GAAG,CAAC,SAAS,CAAC,QAAQ,EAAE,CAAC,CAAC;CAC7B,CAAC,CAAC;AAEH,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,GAAG;IAC9B,GAAG,CAAC,WAAW,CACX,WAAW,CAAC,GAAG,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,KAAK,CAAC,MAAM,SAAS,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,CACpE,CAAC;CACL,CAAC,CAAC;AAEH,SAAS,QAAQ;IACb,OAAO,MAAM;SACR,IAAI,CAAC,KAAK,CAAC;SACX,IAAI,CAAC,KAAK,IACP,KAAK,CAAC,MAAM,CAAC;QACT,IAAI;QACJ,YAAY;QACZ,WAAW;QACX,SAAS;QACT,oBAAoB;QACpB,iBAAiB;QACjB,kBAAkB;QAClB,2BAA2B;QAC3B,0BAA0B;KAC7B,CAAC,CACL,CAAC;CACT;AAED,SAAS,WAAW,CAAC,OAAoB,EAAE,OAAe;IACtD,OAAO,IAAI,OAAO,CAAW,CAAC,OAAO,EAAE,MAAM;QACzC,MAAM,SAAS,GAAG,UAAU,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;QAC9C,KAAK,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,QAAQ;YACxB,YAAY,CAAC,SAAS,CAAC,CAAC;YACxB,OAAO,CAAC,QAAQ,CAAC,CAAC;SACrB,EAAE,MAAM,CAAC,CAAC;KACd,CAAC,CAAC;CACN;AAED,SAAS,SAAS,CAAC,OAAoB;IACnC,OAAO,MAAM;SACR,IAAI,CAAC,KAAK,CAAC;SACX,IAAI,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;SACnC,IAAI,CAAC,QAAQ;QACV,IAAI,QAAQ,EAAE;YACV,OAAO,QAAQ,CAAC;SACnB;aAAM;YACH,MAAM,IAAI,KAAK,CAAC,UAAU,CAAC,CAAC;SAC/B;KACJ,CAAC,CAAC;CACV"}