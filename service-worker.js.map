{"version":3,"file":"service-worker.js","sources":["src/service-worker.ts"],"sourcesContent":["const CACHE = 'network-or-cache';\r\n\r\nexport declare var self: ServiceWorkerGlobalScope;\r\n\r\nself.addEventListener('install', evt => {\r\n    evt.waitUntil(precache());\r\n});\r\n\r\nself.addEventListener('fetch', evt => {\r\n    evt.respondWith(\r\n        fromNetwork(evt.request, 400).catch(() => fromCache(evt.request)),\r\n    );\r\n});\r\n\r\nfunction precache() {\r\n    return caches\r\n        .open(CACHE)\r\n        .then(cache =>\r\n            cache.addAll([\r\n                './',\r\n                'index.html',\r\n                'style.css',\r\n                'main.js',\r\n                'google_transit.zip',\r\n                'assets/logo.svg',\r\n                'assets/lines.svg',\r\n                'roboto/Roboto-Regular.ttf',\r\n                'roboto/Roboto-Medium.ttf',\r\n            ]),\r\n        );\r\n}\r\n\r\nfunction fromNetwork(request: RequestInfo, timeout: number) {\r\n    return new Promise<Response>((resolve, reject) => {\r\n        const timeoutId = setTimeout(reject, timeout);\r\n        fetch(request).then(response => {\r\n            clearTimeout(timeoutId);\r\n            resolve(response);\r\n        }, reject);\r\n    });\r\n}\r\n\r\nfunction fromCache(request: RequestInfo) {\r\n    return caches\r\n        .open(CACHE)\r\n        .then(cache => cache.match(request))\r\n        .then(matching => {\r\n            if (matching) {\r\n                return matching;\r\n            } else {\r\n                throw new Error('no-match');\r\n            }\r\n        });\r\n}\r\n"],"names":["CACHE","self","addEventListener","evt","waitUntil","caches","open","then","cache","addAll","respondWith","request","timeout","Promise","resolve","reject","timeoutId","setTimeout","fetch","response","clearTimeout","fromNetwork","catch","match","matching","Error","fromCache"],"mappings":"AAAA,MAAMA,EAAQ,mBAIdC,KAAKC,iBAAiB,UAAWC,IAC7BA,EAAIC,UAUGC,OACFC,KAAKN,GACLO,KAAKC,GACFA,EAAMC,OAAO,CACT,KACA,aACA,YACA,UACA,qBACA,kBACA,mBACA,4BACA,iCAnBhBR,KAAKC,iBAAiB,QAASC,IAC3BA,EAAIO,YAuBR,SAAqBC,EAAsBC,GACvC,OAAO,IAAIC,QAAkB,CAACC,EAASC,KACnC,MAAMC,EAAYC,WAAWF,EAAQH,GACrCM,MAAMP,GAASJ,KAAKY,IAChBC,aAAaJ,GACbF,EAAQK,IACTJ,KA5BHM,CAAYlB,EAAIQ,QAAS,KAAKW,MAAM,KAgC5C,SAAmBX,GACf,OAAON,OACFC,KAAKN,GACLO,KAAKC,GAASA,EAAMe,MAAMZ,IAC1BJ,KAAKiB,IACF,GAAIA,EACA,OAAOA,EAEP,MAAM,IAAIC,MAAM,eAxCkBC,CAAUvB,EAAIQ"}